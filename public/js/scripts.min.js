"use strict";const account=document.getElementById("account"),appendForms=document.getElementById("append-forms"),favorites=document.getElementById("favorites"),closeFavs=document.getElementById("close-favorites"),favsMovies=document.getElementById("favorites__movies"),time=1900,insertTemplate=(e,t,s=!1)=>{const a=document.getElementById(e),r=document.getElementById(t);if(a&&r){const e=document.importNode(a.content,!0);s&&(r.textContent=""),r.appendChild(e)}else console.error(`La función insertTemplate() dice: El elemento ${e} o ${t} no existen.`)},removeTemplate=e=>{const t=document.getElementById(e);t&&(t.textContent="")},alertEmptyField=(e,t,s)=>{e?(e.classList.add(t),setTimeout(()=>{e.classList.remove(t)},s)):console.error(`La función "alertEmptyField()" dice: El elemento "${e}" no existe.`)},changePlaceholderValue=(e,t,s,a)=>{e?(e.placeholder=t,setTimeout(()=>{e.placeholder=s},a)):console.error(`La función "changePlaceholderValue()" dice: El elemento "${e}" no existe.`)},replaceClass=(e,t,s)=>{const a=document.getElementById(e);a&&a.classList.contains(t)?a.classList.replace(t,s):console.error(`La función "replaceClass()" dice: El elemento "${a}" no existe o no tiene la clase "${t}".`)},loSt=localStorage,setNewUser=e=>{if(null===loSt.getItem("users")){const t=[];t.push(e),loSt.setItem("users",JSON.stringify(t))}else{const t=JSON.parse(loSt.getItem("users"));ifUserExists(e.id)?alert(`El usuario ${e.id} ya existe`):t.push(e),loSt.setItem("users",JSON.stringify(t))}},ifUserExists=e=>{const t=JSON.parse(loSt.getItem("users"));let s=0;return t.forEach(t=>{t.id===e&&(s=1)}),1===s},seSt=sessionStorage,setCurrentUser=e=>{seSt.setItem("currentUser",JSON.stringify(e))},getCurrentUser=()=>JSON.parse(seSt.getItem("currentUser")),currentUserLoggedIn=()=>null!==seSt.getItem("currentUser"),singOff=()=>{seSt.removeItem("currentUser")},apikey="8651a58e",link="http://www.omdbapi.com/?apikey=8651a58e&s=avenger&plot=full";document.addEventListener("DOMContentLoaded",()=>{insertTemplate("login-and-register-template","account"),null===seSt.getItem("currentUser")&&insertTemplate("messages-template","append-forms",!0)}),account.addEventListener("click",e=>{"login-button"===e.target.id&&insertTemplate("login-form-template","append-forms",!0),"register-button"===e.target.id&&insertTemplate("sing-in-template","append-forms",!0),"favorites-button"===e.target.id&&favorites.classList.toggle("favorites__right"),"logout-button"===e.target.id&&(console.log("Se desloqueó"),removeTemplate("append-forms"),replaceClass("append-forms","forms__modal--search","forms__modal--account"),insertTemplate("login-and-register-template","account",!0))}),appendForms.addEventListener("submit",e=>{if(e.preventDefault(),"login-form"===e.target.id){const e=document.getElementById("login-name"),t=document.getElementById("login-pass"),s=e.value.trim(),a=t.value.trim();if(""!==s&&""!==a){setCurrentUser({id:`${s}${a}`}.id),insertTemplate("logged-in-template","account",!0),insertTemplate("search-form-template","append-forms",!0),replaceClass("append-forms","forms__modal--account","forms__modal--search")}else""==s&&(alertEmptyField(e,"alert",1900),changePlaceholderValue(e,"Ingresa un usuario","Usuario",1900)),""==a&&(alertEmptyField(t,"alert",1900),changePlaceholderValue(t,"Ingresa una contraseña","Contraseña",1900))}if("sing-in-form"===e.target.id){const e=document.getElementById("sing-in-name"),t=document.getElementById("sing-in-pass"),s=document.getElementById("repeat-pass"),a=e.value.trim(),r=t.value.trim(),n=s.value.trim();if(""!==a&&""!==r&&""!==n)if(r===n){const e={id:`${a}${r}`,favoriteMovies:[]};setNewUser(e),setCurrentUser(e.id),insertTemplate("logged-in-template","account",!0),insertTemplate("search-form-template","append-forms",!0),replaceClass("append-forms","forms__modal--account","forms__modal--search")}else alertEmptyField(s,"alert",1900);else""==e.value.trim()&&(alertEmptyField(e,"alert",1900),changePlaceholderValue(e,"Ingresa un usuario","Usuario",1900)),""==t.value.trim()&&(alertEmptyField(t,"alert",1900),changePlaceholderValue(t,"Ingresa una contraseña","Contraseña",1900)),""==s.value.trim()&&(alertEmptyField(s,"alert",1900),changePlaceholderValue(s,"Repite la contraseña","Repite la contraseña",1900))}"search-form"===e.target.id&&console.log("Está buscando")}),appendForms.addEventListener("keyup",e=>{if("sing-in-pass"===e.target.id||"repeat-pass"===e.target.id){const e=document.getElementById("sing-in-pass"),t=document.getElementById("repeat-pass"),s=e.value.trim(),a=t.value.trim();""!==s&&""!==t&&(a===s?t.classList.add("equal-to"):t.classList.remove("equal-to"))}}),appendForms.addEventListener("click",e=>{"close"===e.target.dataset.close&&(appendForms.textContent="")}),closeFavs.addEventListener("click",()=>{favorites.classList.remove("favorites__right")});