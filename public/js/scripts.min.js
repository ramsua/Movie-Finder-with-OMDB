"use strict";const appendForms=document.getElementById("append-forms"),account=document.getElementById("account"),time=1900,insertTemplate=(e,t,n=!1)=>{const s=document.getElementById(e),a=document.getElementById(t);if(s&&a){const e=document.importNode(s.content,!0);n&&(a.textContent=""),a.appendChild(e)}else console.error(`La función insertTemplate() dice: El elemento ${e} o ${t} no existen.`)},removeTemplate=e=>{const t=document.getElementById(e);t&&(t.textContent="")},alertEmptyField=(e,t,n,s=!1)=>{e?(e.classList.add(t),s&&(e.setAttribute("type","text"),e.value="Las contraseñas deben coincidir",setTimeout(()=>{e.setAttribute("type","password"),e.value=""},n)),setTimeout(()=>{e.classList.remove(t)},n)):console.error(`La función "alertEmptyField()" dice: El elemento "${e}" no existe.`)},changePlaceholderValue=(e,t,n,s)=>{e?(e.placeholder=t,setTimeout(()=>{e.placeholder=n},s)):console.error(`La función "changePlaceholderValue()" dice: El elemento "${e}" no existe.`)},replaceClass=(e,t,n)=>{e&&e.classList.contains(t)?e.classList.replace(t,n):console.error(`La función "replaceClass()" dice: El elemento "${e}" no existe o no tiene la clase "${t}".`)},insertIfLoggedIn=()=>{var e,t,n;currentUserLoggedIn()&&(t="forms__modal--account",n="forms__modal--search",(e=appendForms)&&e.classList.contains(t)?e.classList.replace(t,n):console.error(`La función "replaceClass()" dice: El elemento "${e}" no existe o no tiene la clase "${t}".`),insertTemplate("search-template","append-forms",!0),insertTemplate("logged-in-template","account",!0))},loSt=localStorage,setNewUser=e=>{if(null===loSt.getItem("users")){const t=[];t.push(e),loSt.setItem("users",JSON.stringify(t))}else{const t=JSON.parse(loSt.getItem("users"));t.push(e),loSt.setItem("users",JSON.stringify(t))}},getUser=e=>{JSON.parse(loSt.getItem("users")).forEach(t=>{t.id===e&&insertIfLoggedIn()})},seSt=sessionStorage,setCurrentUser=e=>{seSt.setItem("currentUser",JSON.stringify(e))},getCurrentUser=()=>JSON.parse(seSt.getItem("currentUser")),currentUserLoggedIn=()=>null!==seSt.getItem("currentUser"),singOff=()=>{seSt.removeItem("currentUser")},apikey="8651a58e",link="http://www.omdbapi.com/?apikey=8651a58e&s=avenger&plot=full";if(currentUserLoggedIn()){insertIfLoggedIn();const e=document.getElementById("logout-button");account.addEventListener("click",t=>{t.target===e&&(insertTemplate("login-and-register-template","account",!0),seSt.removeItem("currentUser"),currentUserLoggedIn(),removeTemplate("append-forms"))})}else{insertTemplate("login-and-register-template","account");const e=document.getElementById("login-button"),t=document.getElementById("sing-in-button");account.addEventListener("click",n=>{if(n.target===e){insertTemplate("login-template","append-forms",!0);const e=document.getElementById("login-form");e.addEventListener("submit",t=>{t.preventDefault();const n=e.loginName.value.trim(),s=e.loginPass.value.trim();if(""!==n&&""!==s){const e={id:`${n}${s}`};setCurrentUser(e),insertIfLoggedIn(),a=e.id,JSON.parse(loSt.getItem("users")).forEach(e=>{e.id===a&&insertIfLoggedIn()})}else""==n&&(alertEmptyField(e.loginName,"alert",1900),changePlaceholderValue(e.loginName,"Ingresa un usuario","Usuario",1900)),""==s&&(alertEmptyField(e.loginPass,"alert",1900),changePlaceholderValue(e.loginPass,"Ingresa una contraseña","Contraseña",1900));var a})}if(n.target===t){insertTemplate("sing-in-template","append-forms",!0);const e=document.getElementById("sing-in-form"),t=e.singInName,n=e.singInPass,s=e.repeatPass;e.addEventListener("submit",a=>{a.preventDefault();const r=t.value.trim(),l=n.value.trim(),o=s.value.trim();if(""!==r&&""!==l&&""!==o)if(l===o){const e={id:`${r}${l}`,favoriteMovies:[]};setCurrentUser(e.id),setNewUser(e),insertIfLoggedIn()}else alertEmptyField(s,"alert",1900,!0);else""==t.value.trim()&&(alertEmptyField(e.singInName,"alert",1900),changePlaceholderValue(e.singInName,"Ingresa un usuario","Usuario",1900)),""==n.value.trim()&&(alertEmptyField(e.singInPass,"alert",1900),changePlaceholderValue(e.singInPass,"Ingresa una contraseña","Contraseña",1900)),""==s.value.trim()&&(alertEmptyField(e.repeatPass,"alert",1900),changePlaceholderValue(e.repeatPass,"Repite la contraseña","Repite la contraseña",1900))}),e.addEventListener("keyup",()=>{const e=n.value.trim(),t=s.value.trim();""!==e&&""!==s&&(t===e?s.classList.add("equal-to"):s.classList.remove("equal-to"))})}})}